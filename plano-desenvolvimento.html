<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechEdu - Plano de Desenvolvimento</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <a href="index.html" class="logo">TechEdu</a>
        <div class="user-profile">
            <a href="#">üë§</a>
        </div>
    </header>

    <main>
        <a href="index.html" class="back-link">&larr; Voltar para planos</a>

        <section class="plan-header">
            <img src="https://i.imgur.com/1nZ2A6s.png" alt="C√≥digo de Desenvolvimento">
            <div class="header-text">
                <h1>Informa√ß√µes do seu plano de Desenvolvimento:</h1>
                <p>√ìtima escolha! Agora personalize seu plano de programa√ß√£o.</p>
            </div>
        </section>

        <section class="plan-form">
            <form action="#" method="POST">
                
                <div class="form-group">
                    <label for="plan-name">Nome do plano</label>
                    <input type="text" id="plan-name" name="plan_name" value="Trilha de Aprendizado em Desenvolvimento">
                </div>

                <div class="form-group">
                    <label for="knowledge-level">Meu N√≠vel de Conhecimento</label>
                    <select id="knowledge-level" name="knowledge_level">
                        <option value="iniciante">Iniciante (Nunca programei)</option>
                        <option value="intermediario">Intermedi√°rio (Sei l√≥gica ou o b√°sico)</option>
                        <option value="avancado">Avan√ßado (J√° crio projetos)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="main-goal">Meu Objetivo Principal</label>
                    <select id="main-goal" name="main_goal">
                        <option value="logica">Aprender l√≥gica de programa√ß√£o</option>
                        <option value="frontend">Criar meu primeiro site (Front-end)</option>
                        <option value="backend">Construir um aplicativo (Back-end)</option>
                        <option value="fullstack">Me tornar um desenvolvedor Full-Stack</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="plan-description">Descri√ß√£o</label>
                    <textarea id="plan-description" name="plan_description" placeholder="Escreva um breve resumo do que voc√™ espera deste plano...">Quero aprender a programar para criar sites e aplicativos, come√ßando do zero.</textarea>
                </div>

                <div class="form-group">
                    <label>T√≥picos de Foco</label>
                    <div class="topics-group">
                        <div class="topic-item">
                            <input type="checkbox" id="topic1" name="topic" value="logica" checked>
                            <label for="topic1">L√≥gica de Programa√ß√£o</label>
                        </div>
                        <div class="topic-item">
                            <input type="checkbox" id="topic2" name="topic" value="htmlcss" checked>
                            <label for="topic2">HTML & CSS</label>
                        </div>
                        <div class="topic-item">
                            <input type="checkbox" id="topic3" name="topic" value="javascript" checked>
                            <label for="topic3">JavaScript</label>
                        </div>
                        <div class="topic-item">
                            <input type="checkbox" id="topic4" name="topic" value="python">
                            <label for="topic4">Python</label>
                        </div>
                        <div class="topic-item">
                            <input type="checkbox" id="topic5" name="topic" value="csharp">
                            <label for="topic5">C#</label>
                        </div>
                        <div class="topic-item">
                            <input type="checkbox" id="topic6" name="topic" value="git">
                            <label for="topic6">Git e GitHub</label>
                        </div>
                    </div>
                </div>

                <div class="form-group-toggle">
                    <span>Tornar este plano p√∫blico?</span>
                    <label class="switch">
                        <input type="checkbox" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                
                <button type="submit" class="submit-button">Gerar meu Plano de Estudos</button>
            </form>
            
            </section>
    </main>

    <script>
        // Esta l√≥gica √© id√™ntica √† do plano-hardware.html
        // A √∫nica diferen√ßa √© a fun√ß√£o de simula√ß√£o abaixo.

        const planForm = document.querySelector('.plan-form form');
        const submitButton = document.querySelector('.submit-button');

        planForm.addEventListener('submit', async function(event) {
            event.preventDefault(); 
            const formData = new FormData(planForm);
            
            const data = {
                topics: []
            };
            formData.forEach((value, key) => {
                if (key === 'topic') {
                    data.topics.push(value);
                } else {
                    data[key] = value;
                }
            });

            submitButton.textContent = 'Gerando seu plano...';
            submitButton.disabled = true;

            try {
                const simulatedResponse = await generateSimulatedPlan(data);
                const oldResult = document.querySelector('.plan-result');
                if(oldResult) oldResult.remove();

                const resultDiv = document.createElement('div');
                resultDiv.className = 'plan-result';
                resultDiv.innerHTML = simulatedResponse;
                planForm.after(resultDiv);

                activateProgressBar();
                submitButton.textContent = 'Plano Gerado com Sucesso!';
            } catch (error) {
                submitButton.textContent = 'Erro ao gerar. Tente novamente.';
            } finally {
                submitButton.disabled = false;
            }
        });

        function activateProgressBar() {
            const allTasks = document.querySelectorAll('.task-checkbox');
            const progressBarFill = document.querySelector('.progress-bar-fill');
            const progressText = document.querySelector('.progress-text');
            const totalTasks = allTasks.length;

            if (totalTasks === 0) return;

            function updateProgress() {
                const checkedTasks = document.querySelectorAll('.task-checkbox:checked').length;
                const percentage = (checkedTasks / totalTasks) * 100;
                
                progressBarFill.style.width = `${percentage}%`;
                progressText.textContent = `Progresso: ${Math.round(percentage)}% (${checkedTasks} de ${totalTasks} tarefas)`;
            }

            allTasks.forEach(task => {
                task.addEventListener('change', updateProgress);
            });
            updateProgress();
        }

        /**
         * FUN√á√ÉO DE SIMULA√á√ÉO (API de IA) - Vers√£o Desenvolvimento
         */
        async function generateSimulatedPlan(data) {
            console.log("Dados enviados para a IA:", data);
            await new Promise(resolve => setTimeout(resolve, 1500)); 

            let planHtml = `
                <h2>Seu Plano de Desenvolvimento (N√≠vel: ${data.knowledge_level})</h2>
                <p><strong>Objetivo:</strong> ${data.main_goal}</p>

                <div class="progress-section">
                    <div class="progress-text">Progresso: 0% (0 de X tarefas)</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar-fill"></div>
                    </div>
                </div>

                <div class="plan-modules">
            `;

            // M√≥dulos Condicionais
            if (data.topics.includes('logica')) {
                planHtml += `
                <div class="module">
                    <div class="module-header">M√≥dulo 1: L√≥gica de Programa√ß√£o</div>
                    <ul class="task-list">
                        <li class="task-item">
                            <input type="checkbox" id="task-dev-1-1" class="task-checkbox">
                            <label for="task-dev-1-1">O que s√£o Vari√°veis?</label>
                        </li>
                        <li class="task-item">
                            <input type="checkbox" id="task-dev-1-2" class="task-checkbox">
                            <label for="task-dev-1-2">O que s√£o Condicionais (If/Else)?</label>
                        </li>
                        <li class="task-item">
                            <input type="checkbox" id="task-dev-1-3" class="task-checkbox">
                            <label for="task-dev-1-3">O que s√£o Loops (For/While)?</label>
                        </li>
                    </ul>
                </div>
                `;
            }

            if (data.topics.includes('htmlcss')) {
                planHtml += `
                <div class="module">
                    <div class="module-header">M√≥dulo 2: HTML & CSS</div>
                    <ul class="task-list">
                        <li class="task-item">
                            <input type="checkbox" id="task-dev-2-1" class="task-checkbox">
                            <label for="task-dev-2-1">Criando seu primeiro HTML</label>
                        </li>
                        <li class="task-item">
                            <input type="checkbox" id="task-dev-2-2" class="task-checkbox">
                            <label for="task-dev-2-2">Estilizando com CSS</label>
                        </li>
                    </ul>
                </div>
                `;
            }
            
            if (data.topics.includes('git')) {
                planHtml += `
                <div class="module">
                    <div class="module-header">M√≥dulo 3: Git e GitHub</div>
                    <ul class="task-list">
                        <li class="task-item">
                            <input type="checkbox" id="task-dev-3-1" class="task-checkbox">
                            <label for="task-dev-3-1">O que √© Controle de Vers√£o?</label>
                        </li>
                        <li class="task-item">
                            <input type="checkbox" id="task-dev-3-2" class="task-checkbox">
                            <label for="task-dev-3-2">Criando seu primeiro Reposit√≥rio</label>
                        </li>
                    </ul>
                </div>
                `;
            }

            planHtml += `</div>`;
            return planHtml;
        }
    </script>
</body>
</html>